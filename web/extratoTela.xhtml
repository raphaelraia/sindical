<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui">

    <h:head>
        <title>Sindical - Extrato Tela</title>
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
        <link rel="shortcut icon" href="#{facesContext.externalContext.requestContextPath}/Imagens/favicon.ico"/>  
        <style type="text/css">
            .ui-widget-content .ui-inputfield{ padding: 8px!important; } 
            .ui-button { padding: 3px!important; }
            .ui-selectonemenu {padding-right: 25px!important;}

            .tblExtratoTelaX{ background-color: #ff9587!important; }
            .tblExtratoTelaX:hover{ background-color: #fe887f!important; }

            .tblExtratoTelaT1{ background-color: #c7ffc7!important; }
            .tblExtratoTelaT2{  }
        </style>

        <script type="text/javascript">

        </script>
    </h:head>
    <h:body>
        <!-- INICIA DIV wrap e main -->
        <div id="wrapx">
            <div id="mainx">
                <!-- INICIA DIV wrap e main -->  
                <f:subview id="header">
                    <ui:include src="templates/templatePrime.xhtml"/>
                    <ui:include src="templates/templateStatus.xhtml"/>
                </f:subview>
                <f:view>
                    <p:panel style="margin: 0 auto; border: 0; width: #{configuracaoBean.resolucao.tipoResolucao.tamanho}">
                        <h:outputText value="Extrato Tela" styleClass="fonteHeader" />
                        <div class="clear"></div>
                        <h:form id="formExtratoTela">

                            <p:panel>
                                <f:facet name="header">
                                    <h:panelGrid id="header_opcoes" columns="7" cellspacing="6" style="width: 100%">
                                        <h:column>
                                            <h:panelGrid>
                                                <p:outputLabel value="Filtrar por" />
                                                <h:column>
                                                    <p:selectOneMenu value="#{extratoTelaBean.porPesquisa}" rendered="#{controleAcessoBean.getListaExtratoTela(false)}">
                                                        <p:ajax event="change" update="@this :formExtratoTelaOpcoes:i_reativar_bol" global="false"/>
                                                        <f:selectItem itemValue="todos"             itemLabel="Todas"/>
                                                        <f:selectItem itemValue="recebidas"         itemLabel="Recebidas"/>
                                                        <f:selectItem itemValue="nao_recebidas"      itemLabel="Não Recebidas"/>
                                                        <f:selectItem itemValue="atrasadas"         itemLabel="Atrasadas"/>
                                                        <f:selectItem itemValue="excluidos"         itemLabel="Excluídos" itemDisabled="#{segurancaUtilitariosBean.sessaoUsuario.id != 1}"/>
                                                    </p:selectOneMenu>

                                                    <p:selectOneMenu value="#{extratoTelaBean.porPesquisa}" rendered="#{!controleAcessoBean.getListaExtratoTela(false)}">
                                                        <p:ajax event="change" update="@this" global="false"/>
                                                        <f:selectItem itemValue="nao_recebidas"      itemLabel="Não Recebidas"/>
                                                        <f:selectItem itemValue="atrasadas"         itemLabel="Atrasadas"/>
                                                    </p:selectOneMenu>
                                                </h:column>
                                            </h:panelGrid>
                                        </h:column>

                                        <h:column>
                                            <h:panelGrid>
                                                <p:outputLabel value="Gerados pela Caixa"/>
                                                <p:selectOneMenu value="#{extratoTelaBean.geraPesquisa}">
                                                    <p:ajax event="change" update="@this" global="false"/>
                                                    <f:selectItem itemValue="sim"               itemLabel="Sim"/>
                                                    <f:selectItem itemValue="nao"               itemLabel="Não"/>
                                                    <f:selectItem itemValue="naoVerificar"      itemLabel="Não Verificar"/>
                                                </p:selectOneMenu>
                                            </h:panelGrid>
                                        </h:column>

                                        <h:column>
                                            <h:panelGrid>
                                                <p:outputLabel value="Status do Boleto"/>
                                                <p:selectOneMenu value="#{extratoTelaBean.indexListaStatusRetorno}" autoWidth="false" style="width: 120px">
                                                    <p:ajax event="change" update="@this header_opcoes" global="false" listener="#{extratoTelaBean.changeStatusRetorno}"/>
                                                    <f:selectItems value="#{extratoTelaBean.listaStatusRetorno}" />
                                                </p:selectOneMenu>
                                            </h:panelGrid>
                                        </h:column>

                                        <h:column>
                                            <h:panelGrid>                                    
                                                <p:outputLabel value="Ordenação" />
                                                <p:selectOneMenu value="#{extratoTelaBean.ordenacao}" style="width: 100px!important" autoWidth="false">
                                                    <p:ajax event="change" update="@this" global="false"/>
                                                    <f:selectItem itemValue="referencia"        itemLabel="Referência"/>
                                                    <f:selectItem itemValue="vencimento"        itemLabel="Vencimento"/>
                                                    <f:selectItem itemValue="baixa"          itemLabel="Baixa"/>
                                                    <f:selectItem itemValue="ocorrencia"        itemLabel="Recebimento(Ocorrência)" />
                                                    <f:selectItem itemValue="importacao"        itemLabel="Importação"/>
                                                    <f:selectItem itemValue="lancamento"        itemLabel="Lançamento"/>
                                                    <f:selectItem itemValue=""                  itemLabel="           " itemDisabled="true"/>
                                                    <f:selectItem itemValue="contribuicao"      itemLabel="- Contribuição"/>
                                                    <f:selectItem itemValue="empresa"           itemLabel="- Empresa"/>
                                                </p:selectOneMenu>
                                            </h:panelGrid>
                                        </h:column>

                                        <h:column>
                                            <h:panelGrid>                                    
                                                <p:outputLabel value="Filial" rendered="false"/>
                                                <p:selectOneMenu value="#{extratoTelaBean.idFilial}" style="width: 330px!important" autoWidth="false" rendered="false">
                                                    <p:ajax event="change" update="@this"  global="false" />
                                                    <f:selectItems value="#{extratoTelaBean.listaFilial}"/> 
                                                </p:selectOneMenu>  
                                            </h:panelGrid>
                                        </h:column>

                                        <h:column>
                                            <h:panelGrid>                                    
                                                <p:outputLabel value="Conta Cobrança" />
                                                <h:panelGrid rendered="#{extratoTelaBean.statusRemessa.id eq -1}">
                                                    <p:selectOneMenu value="#{extratoTelaBean.indexConta}" autoWidth="false" style="width: 200px">
                                                        <p:ajax event="change" update="formExtratoTela" listener="#{extratoTelaBean.alterarContaRemessa()}"/>
                                                        <f:selectItems value="#{extratoTelaBean.listaConta}" />
                                                    </p:selectOneMenu>
                                                </h:panelGrid>                                    

                                                <h:panelGrid rendered="#{extratoTelaBean.statusRemessa.id ne -1}">
                                                    <h:panelGrid columns="2">
                                                        <p:outputLabel value="#{extratoTelaBean.contaSelecionada.apelido} - #{extratoTelaBean.contaSelecionada.codCedente} - #{extratoTelaBean.contaSelecionada.contaBanco.banco.banco}" style="font-weight: bold; font-size: 11pt!important"/>
                                                        <p:commandButton icon="ui-icon-close" action="#{extratoTelaBean.fecharModalRemessa()}" update="formExtratoTela, formExtratoTelaOpcoes"/>
                                                    </h:panelGrid>
                                                </h:panelGrid>
                                            </h:panelGrid>
                                        </h:column>

                                        <h:column>
                                            <br />
                                            <p:commandButton value="FILTRAR LISTA" style="float: right; font-weight: bold; margin-left: 50px" action="#{extratoTelaBean.loadListBeta()}" update="formExtratoTela" />
                                        </h:column>
                                    </h:panelGrid>
                                </f:facet>
                                <h:panelGrid columns="3">
                                    <h:column>
                                        <p:panel id="i_fieldset_data" header="DATA" style="height: 160px; width: 240px">
                                            <h:panelGrid>
                                                <h:column>
                                                    <h:panelGrid columns="2">
                                                        <p:selectOneMenu value="#{extratoTelaBean.tipoDataPesquisa}" style="width: 100px!important" autoWidth="false">
                                                            <p:ajax event="change" update="i_fieldset_data" global="false" listener="#{extratoTelaBean.limparDatas}"/>
                                                            <f:selectItem itemValue="importacao"  itemLabel="Importação" />
                                                            <f:selectItem itemValue="ocorrencia"  itemLabel="Recebimento(Ocorrência)" />
                                                            <f:selectItem itemValue="vencimento"  itemLabel="Vencimento" />
                                                            <f:selectItem itemValue="baixa"       itemLabel="Baixa" />
                                                            <f:selectItem itemValue="referencia"  itemLabel="Referência" />
                                                            <f:selectItem itemValue="lancamento"  itemLabel="Lançamento" />
                                                            <f:selectItem itemValue="registro"    itemLabel="Registro" />
                                                        </p:selectOneMenu>
                                                        <p:selectOneMenu value="#{extratoTelaBean.tipoData}">
                                                            <p:ajax event="change" update="i_fieldset_data" global="false" listener="#{extratoTelaBean.limparTipoDatas}"/>
                                                            <f:selectItem itemValue="igual" itemLabel="Igual" />
                                                            <f:selectItem itemValue="apartir" itemLabel="A partir" />
                                                            <f:selectItem itemValue="ate" itemLabel="Até" />
                                                            <f:selectItem itemValue="faixa" itemLabel="Faixa" />
                                                        </p:selectOneMenu>                                                        
                                                    </h:panelGrid>
                                                </h:column>
                                                <h:column>
                                                    <h:panelGrid columns="2" rendered="#{extratoTelaBean.tipoDataPesquisa ne 'referencia'}" style="width: 100%">
                                                        <p:outputLabel value="Data #{extratoTelaBean.tipoData eq 'faixa' ? 'Inicial' : ''}" style="font-weight: bold"/>
                                                        <p:inputMask value="#{extratoTelaBean.dataInicial}" mask="99/99/9999" style="width: 100px; text-align: center; font-size: 10pt!important; float: right" placeholder="__/__/____" converter="#{isDateString}">
                                                            <p:ajax event="change" update="@this" global="false"/>
                                                        </p:inputMask>
                                                        <p:outputLabel value="Data Final:" style="font-weight: bold" rendered="#{extratoTelaBean.tipoData eq 'faixa'}"/>
                                                        <p:inputMask value="#{extratoTelaBean.dataFinal}" mask="99/99/9999" style="width: 100px; text-align: center; font-size: 10pt!important; float: right" placeholder="__/__/____" converter="#{isDateString}" rendered="#{extratoTelaBean.tipoData eq 'faixa'}">
                                                            <p:ajax event="change" update="@this" global="false"/>
                                                        </p:inputMask>
                                                    </h:panelGrid>
                                                </h:column>
                                                <h:column>
                                                    <h:panelGrid columns="2" rendered="#{extratoTelaBean.tipoDataPesquisa eq 'referencia'}" style="width: 100%">
                                                        <p:outputLabel value="Mês/Ano #{extratoTelaBean.tipoData eq 'faixa' ? 'Inicial' : ''}" style="font-weight: bold"/>
                                                        <p:inputMask value="#{extratoTelaBean.dataRefInicial}" mask="99/9999" style="width: 100px; text-align: center; font-size: 10pt!important; float: right" placeholder="__/____" converter="#{isDateReference}">
                                                            <p:ajax event="change" update="@this" global="false"/>
                                                        </p:inputMask>

                                                        <p:outputLabel value="Mês/Ano Final:" style="font-weight: bold" rendered="#{extratoTelaBean.tipoData eq 'faixa'}"/>
                                                        <p:inputMask value="#{extratoTelaBean.dataRefFinal}" mask="99/9999" style="width: 100px; text-align: center; font-size: 10pt!important; float: right" placeholder="__/____" converter="#{isDateReference}" rendered="#{extratoTelaBean.tipoData eq 'faixa'}">
                                                            <p:ajax event="change" update="@this" global="false"/>
                                                        </p:inputMask>
                                                    </h:panelGrid>
                                                </h:column>
                                            </h:panelGrid>
                                        </p:panel>
                                    </h:column>

                                    <h:column>
                                        <p:panel id="i_fieldset_boleto" header="Nº DE BOLETO"  style="height: 160px; width: 190px">

                                            <h:panelGrid>
                                                <p:outputLabel value="Boleto Inicial" style="font-weight: bold"/>
                                                <p:inputText value="#{extratoTelaBean.boletoInicial}" style="text-align: right" converter="#{thisNumber}">
                                                    <p:ajax event="change" update="@this" global="false"/>
                                                </p:inputText>
                                                <p:outputLabel value="Boleto Final" style="font-weight: bold"/>
                                                <p:inputText value="#{extratoTelaBean.boletoFinal}" style="text-align: right" converter="#{thisNumber}">
                                                    <p:ajax event="change" update="@this" global="false"/>
                                                </p:inputText>
                                            </h:panelGrid>
                                        </p:panel>
                                    </h:column>

                                    <h:column>
                                        <p:panel id="i_fieldset_pessoa" header="CONTRIBUIÇÃO E PESSOA" toggleable="false" toggleSpeed="500" style="height: 160px">

                                            <h:panelGrid columns="2">
                                                <h:column>
                                                    <p:outputLabel value="Contribuição" style="font-weight: bold"/><br />
                                                    <p:selectOneMenu value="#{extratoTelaBean.idContribuicao}">
                                                        <p:ajax event="change" update="@this" global="false"/>
                                                        <f:selectItems value="#{extratoTelaBean.listaServico}"/>
                                                    </p:selectOneMenu>
                                                </h:column>

                                                <h:column>
                                                    <p:outputLabel value="Tipo" style="font-weight: bold"/><br />
                                                    <p:selectOneMenu value="#{extratoTelaBean.idTipoServico}">
                                                        <p:ajax event="change" update="@this" global="false"/>
                                                        <f:selectItems value="#{extratoTelaBean.listaTipoServico}"/>
                                                    </p:selectOneMenu>
                                                </h:column>
                                            </h:panelGrid>

                                            <h:panelGrid columns="3">
                                                <h:column>
                                                    <h:panelGrid>
                                                        <p:outputLabel value="Pessoa" styleClass="bold"/>                                                        
                                                    </h:panelGrid>
                                                    <h:panelGrid columns="4">
                                                        <p:inputMask value="#{extratoTelaBean.pessoa_documento}" style="width: 135px; font-weight: bold" styleClass="text-center" rendered="#{extratoTelaBean.pessoa.id eq -1}"  mask="99.999.999/9999-99">
                                                            <p:ajax event="change" update=":formExtratoTela:" listener="#{extratoTelaBean.findPessoaBy}" />
                                                        </p:inputMask>
                                                        <p:inputText value="#{extratoTelaBean.pessoa.documento}" readonly="true" style="width: 135px; font-weight: bold;" styleClass="text-center" rendered="#{extratoTelaBean.pessoa.id ne -1}"/>
                                                        <p:inputText value="#{extratoTelaBean.pessoa.nome}" readonly="true" style="width: #{(configuracaoBean.resolucao.tipoResolucao.tamanho eq '1200' || empty configuracaoBean.resolucao.tipoResolucao.tamanho) ? '445px' : '260px'}; font-weight: bold" />
                                                        <p:commandButton icon="ui-icon-search" alt="Pesquisar Pessoa" action="#{chamadaPaginaBean.pesquisaPessoa}" />
                                                        <p:commandButton icon="ui-icon-close" alt="Excluir Pessoa" action="#{extratoTelaBean.limparPesquisaPessoa}" update=":formExtratoTela:" />                                                        
                                                    </h:panelGrid>
                                                </h:column>
                                            </h:panelGrid>

                                            <h:panelGrid rendered="#{extratoTelaBean.listaEmpresasPertencentes.size() gt 1}">
                                                <h:column>
                                                    <p:selectBooleanCheckbox value="#{extratoTelaBean.movimentosDasEmpresas}" itemLabel="Ver os movimentos das empresas vinculadas">
                                                        <p:ajax event="change" update="@form" />
                                                    </p:selectBooleanCheckbox>
                                                </h:column>
                                            </h:panelGrid>                                            
                                        </p:panel>
                                    </h:column>

                                </h:panelGrid>
                            </p:panel>
                            <p:messages id="i_msg" closable="true" showDetail="true" autoUpdate="true"/>
                            <p:dataTable value="#{extratoTelaBean.listaMovimentos}" var="movimentos" id="tbl" rows="10" rowStyleClass="#{movimentos.argumento26}" emptyMessage="Nenhum Boleto Pesquisado" scrollable="true" scrollHeight="300" paginator="true" scrollWidth="100%" rowIndexVar="index">
                                <f:facet name="header">
                                    <h:panelGroup>
                                        <br />
                                        <p:selectBooleanCheckbox value="#{extratoTelaBean.selecionaTodos}" itemLabel="Selecionar Todos Movimentos da lista" styleClass="font-color-red float-left">
                                            <p:ajax event="change" update="@this @form" listener="#{extratoTelaBean.marcarTodos()}"/>
                                        </p:selectBooleanCheckbox>
                                        <br />
                                    </h:panelGroup>
                                </f:facet>

                                <p:column style="width:15px">  
                                    <p:rowToggler />  
                                </p:column>  

                                <p:column style="width:15px; text-align: center">
                                    <p:selectBooleanCheckbox value="#{movimentos.argumento0}" disabled="#{(extratoTelaBean.porPesquisa eq 'excluidos' and segurancaUtilitariosBean.sessaoUsuario.id != 1)}">
                                        <p:ajax event="change" update="@this" global="false"/>
                                    </p:selectBooleanCheckbox>
                                </p:column>

                                <p:column headerText="CNPJ" rendered="#{(extratoTelaBean.pessoa.id == -1 or extratoTelaBean.listaEmpresasPertencentes.size() gt 1) and configuracaoBean.resolucao.tipoResolucao.id != 2}" style="width: 110px">
                                    <p:outputLabel value="#{movimentos.argumento4}"/>
                                </p:column>

                                <p:column headerText="Razão" rendered="#{extratoTelaBean.pessoa.id == -1 or extratoTelaBean.listaEmpresasPertencentes.size() gt 1}">
                                    <p:outputLabel value="#{movimentos.argumento5}"/>
                                </p:column>

                                <p:column headerText="Boleto" style="width: 115px; text-align: center">
                                    <p:outputLabel value="#{movimentos.argumento6}"/>
                                </p:column>

                                <p:column headerText="Contr. / Tipo" style="width: 110px">
                                    <p:outputLabel value="#{movimentos.argumento7} - #{movimentos.argumento14}"/>
                                </p:column>

                                <p:column headerText="Ref" style="width: 45px; text-align: center">
                                    <p:outputLabel value="#{movimentos.argumento8}"/>
                                </p:column>

                                <p:column headerText="Vencto" style="width: 60px; text-align: center">
                                    <h:column rendered="#{(movimentos.argumento21 == true) and (controleAcessoBean.botaoAlterarDataVenctoExtrato == false)}">
                                        <p:commandLink value="#{movimentos.argumento9}" action="#{extratoTelaBean.carregaDataAntiga(movimentos.argumento1)}" oncomplete="PF('dlg_alterar_vencimento').show();" style="color: blue" update=":formExtratoTelaAlteraVencimento :formExtratoTela:i_msg">

                                        </p:commandLink>
                                    </h:column> 

                                    <h:column rendered="#{movimentos.argumento21 == false || controleAcessoBean.botaoAlterarDataVenctoExtrato == true}">
                                        <p:outputLabel value="#{movimentos.argumento9}"/>
                                    </h:column>
                                </p:column>

                                <p:column headerText="Valor" style="width: 60px" rendered="#{!controleAcessoBean.verificarPermissao('visualizar_valor', 4)}">
                                    <p:outputLabel value="#{movimentos.argumento11}" style="float: right"/>
                                </p:column>

                                <p:column headerText="#{extratoTelaBean.tipoDataPesquisa eq 'baixa' ? 'Baixa' : 'Recebimento(Ocorrência)'}" style="text-align: center; width: 60px">
                                    <p:outputLabel value="#{extratoTelaBean.tipoDataPesquisa eq 'baixa' ? movimentos.argumento15 : movimentos.argumento31}">
                                        <f:convertDateTime />
                                    </p:outputLabel>
                                </p:column>

                                <p:column headerText="Vlr Baixa" style="width: 60px" rendered="#{!controleAcessoBean.verificarPermissao('visualizar_valor_baixa', 4)}">
                                    <p:outputLabel value="#{movimentos.argumento25}" style="float: right"/>
                                </p:column>

                                <p:column headerText="Taxa" style="width: 30px" rendered="#{!controleAcessoBean.verificarPermissao('visualizar_valor_baixa', 4)}">
                                    <p:outputLabel value="#{movimentos.argumento12}" style="float: right"/>
                                </p:column>

                                <p:column headerText="Ult. Imp" style="width: 30px; text-align: center">
                                    <p:commandButton icon="ui-icon-newwin" oncomplete="PF('dlg_ultima_impressao').show()" rendered="#{extratoTelaBean.getUltimaImpressao(movimentos.argumento1)}" action="#{extratoTelaBean.verUltimaImpressão(movimentos.argumento1)}" title="Ver Lista de Impressões" update=":formExtratoTela:i_tbl_impressao" />
                                </p:column>

                                <p:column style="text-align: center; width: 50px" headerText="" >
                                    <p:commandLink value="Alterar Movimento" action="#{extratoTelaBean.alterarMovimento(movimentos.argumento1)}" rendered="#{movimentos.argumento15 ne ''}" disabled="#{controleAcessoBean.botaoAlterarMovimento}"/>
                                </p:column>

                                <p:rowExpansion>
                                    <h:panelGrid columns="4" style="height: 40px" styleClass="sbb">
                                        <p:column>
                                            <p:outputLabel value="ID" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento1}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Lote Baixa" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento22}"/>
                                        </p:column>

                                        <p:column rendered="#{configuracaoBean.resolucao.tipoResolucao.id == 2}">
                                            <p:outputLabel value="CNPJ" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento4}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Beneficiário" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento23}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Filial" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento24}"/>
                                        </p:column>

                                        <p:column rendered="#{movimentos.argumento13 ne null}">
                                            <p:outputLabel value="Usuário" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento13}"/>
                                        </p:column>

                                        <p:column rendered="#{movimentos.argumento10 ne ''}">
                                            <p:outputLabel value="Importação" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento10}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Acordo" style="font-weight: bold" rendered="#{not empty movimentos.argumento27}" /><br />
                                            <p:commandLink value="#{movimentos.argumento27[0].acordo.id} (Visualizar)" rendered="#{not empty movimentos.argumento27}"  action="#{extratoTelaBean.setListMovimentosAcordo(movimentos.argumento27)}" onclick="PF('dlg_acordos').show()" update=":formExtratoTelaOpcoes:i_m_a" styleClass="bold font-color-blue" title="Visualizar esta lista"/>
                                        </p:column>

                                        <p:column>
                                            <p:column style="text-align: center; width: 30px" headerText="Recibo" rendered="#{extratoTelaBean.porPesquisa == 'recebidas'}">
                                                <h:commandLink target="#{baixaGeralBean.targetImprimeRecibo(movimentos.argumento1)}" action="#{baixaGeralBean.recibo2Via(movimentos.argumento1)}" rendered="#{movimentos.argumento28 eq 'CAIXA'}" title="Imprimir este Recibo">
                                                    <p:commandButton icon="ui-icon-print" title="Imprimir este Recibo" value="2ª Via de Recibo"/>
                                                </h:commandLink>
                                            </p:column>
                                        </p:column>
                                    </h:panelGrid>

                                    <h:panelGrid columns="4" style="height: 40px" styleClass="sbb"  rendered="#{movimentos.argumento22 ne 0}">
                                        <p:commandButton value="FORMAS DE PAGTO" update=":formExtratoTela:i_forma_pagto_baixa" onclick="PF('dlg_forma_pagto_baixa').show()" action="#{financeiroCardBean.cardFormaPagamentoBaixa(movimentos.argumento22)}" title="Ver detalhes"/>
                                    </h:panelGrid>

                                    <h:panelGrid columns="6"  cellspacing="10" styleClass="sbb">
                                        <p:column>
                                            <p:outputLabel value="Vencto Original" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento29.vencimentoOriginal}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Lançamento" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{movimentos.argumento29.lote.lancamento}"/>
                                        </p:column>


                                        <p:column>
                                            <c:choose>
                                                <c:when test="#{extratoTelaBean.tipoDataPesquisa eq 'importacao' or extratoTelaBean.tipoDataPesquisa eq 'vencimento' or extratoTelaBean.tipoDataPesquisa eq 'baixa' or extratoTelaBean.tipoDataPesquisa eq 'referencia' or extratoTelaBean.tipoDataPesquisa eq 'lancamento'or extratoTelaBean.tipoDataPesquisa eq 'registro'}">
                                                    <p:outputLabel value="Recebimento(Ocorrência)" style="font-weight: bold" /><br />
                                                    <p:outputLabel value="#{movimentos.argumento31}">
                                                        <f:convertDateTime />
                                                    </p:outputLabel>
                                                </c:when>                                                
                                                <c:when test="#{extratoTelaBean.tipoDataPesquisa eq 'ocorrencia'}">
                                                    <p:outputLabel value="Baixa" style="font-weight: bold"  /><br />
                                                    <p:outputLabel value="#{movimentos.argumento15}">
                                                        <f:convertDateTime />
                                                    </p:outputLabel>
                                                </c:when>
                                            </c:choose>
                                        </p:column>
                                        
                                        <p:column  styleClass="text-center">
                                            <p:commandButton icon="ui-icon-comment" value="MENSAGEM BOLETO" action="#{extratoTelaBean.openHistorico(index)}" onclick="PF('dlg_message_historico').show()" update=":formExtratoTela:id_message_historico" title="MENSAGEM BOLETO" rendered="#{movimentos.argumento14 ne 'Acordo'}"/>
                                        </p:column>                                        

                                    </h:panelGrid>

                                    <h:panelGrid columns="1" styleClass="sbb">
                                        <hr />
                                        <h:outputLabel value="DADOS DO BOLETO" style="font-size: 11pt!important; font-weight: bold"/>
                                        <hr />
                                        <h:panelGrid columns="6"  cellspacing="10" styleClass="sbb">
                                            <p:column rendered="#{movimentos.argumento29.boleto.statusRetorno ne null}">
                                                <p:outputLabel value="Status" style="font-weight: bold"/><br />
                                                <p:outputLabel value="#{movimentos.argumento29.boleto.statusRetorno.descricao}" style="font-weight: bold; font-size: 11pt!important; color: red"/>
                                            </p:column>

                                            <p:column rendered="#{movimentos.argumento29.boleto.statusRetorno ne null}">
                                                <p:outputLabel value="Data do Processo" style="font-weight: bold"/><br />
                                                <p:outputLabel value="#{movimentos.argumento29.boleto.dtStatusRetornoString}" style="font-weight: bold; font-size: 11pt!important; color: red"/>
                                            </p:column>

                                            <p:column>
                                                <p:outputLabel value="Vencimento" style="font-weight: bold"/><br />
                                                <p:outputLabel value="#{movimentos.argumento29.boleto.vencimento}" style="font-weight: bold; font-size: 11pt!important; color: red"/>
                                            </p:column>

                                            <p:column>
                                                <p:outputLabel value="Valor" style="font-weight: bold"/><br />
                                                <p:outputLabel value="#{movimentos.argumento29.boleto.valorString}" style="font-weight: bold; font-size: 11pt!important; color: red"/>
                                            </p:column>
                                        </h:panelGrid>
                                    </h:panelGrid>
                                </p:rowExpansion>                                
                            </p:dataTable>


                            <!-- NOVA LISTA DE MOVIMENTOS EXTRATO -->
                            <p:dataTable value="#{extratoTelaBean.listMovimentos}" var="m" id="tbl2" rows="10" rowStyleClass="#{m.rowStyleClass}" emptyMessage="Nenhum Boleto Pesquisado" scrollable="true" scrollHeight="300" paginator="true" scrollWidth="100%" rowIndexVar="index2" rendered="false">
                                <p:column width="15">  
                                    <p:rowToggler />  
                                </p:column>  

                                <p:column width="15" styleClass="text-center">
                                    <p:selectBooleanCheckbox value="#{m.selected}" disabled="#{(extratoTelaBean.porPesquisa eq 'excluidos' and segurancaUtilitariosBean.sessaoUsuario.id != 1)}">
                                        <p:ajax event="change" update="@this" global="false"/>
                                    </p:selectBooleanCheckbox>
                                </p:column>

                                <p:column headerText="CNPJ" width="110" rendered="#{(extratoTelaBean.pessoa.id == -1 or extratoTelaBean.listaEmpresasPertencentes.size() gt 1) and configuracaoBean.resolucao.tipoResolucao.id != 2}">
                                    <p:outputLabel value="#{m.documento}"/>
                                </p:column>

                                <p:column headerText="Razão" rendered="#{extratoTelaBean.pessoa.id == -1 or extratoTelaBean.listaEmpresasPertencentes.size() gt 1}">
                                    <p:outputLabel value="#{m.nome}"/>
                                </p:column>

                                <p:column headerText="Boleto" width="115" styleClass="text-center">
                                    <p:outputLabel value="#{m.boleto}"/>
                                </p:column>

                                <p:column headerText="Contr. / Tipo" width="110">
                                    <p:outputLabel value="#{m.contribuicao} - #{m.servico_tipo}"/>
                                </p:column>

                                <p:column headerText="Ref" width="45" styleClass="text-center">
                                    <p:outputLabel value="#{m.referencia}"/>
                                </p:column>

                                <p:column headerText="Vencto" width="60" styleClass="text-center">
                                    <h:column rendered="#{(m.habilita_data == true) and (controleAcessoBean.botaoAlterarDataVenctoExtrato == false)}">
                                        <p:commandLink value="#{m.vencimento}" action="#{extratoTelaBean.carregaDataAntiga(m.id)}" oncomplete="PF('dlg_alterar_vencimento').show();" style="color: blue" update=":formExtratoTelaAlteraVencimento :formExtratoTela:i_msg">

                                        </p:commandLink>
                                    </h:column> 

                                    <h:column rendered="#{m.habilita_data == false || controleAcessoBean.botaoAlterarDataVenctoExtrato == true}">
                                        <p:outputLabel value="#{m.vencimento}"/>
                                    </h:column>
                                </p:column>

                                <p:column headerText="Valor" width="60" styleClass="text-center">
                                    <p:outputLabel value="#{m.valor}" styleClass="float-right"/>
                                </p:column>

                                <p:column headerText="Quitação" width="60" >
                                    <p:outputLabel value="#{m.quitacao}"/>
                                </p:column>

                                <p:column headerText="Vlr Baixa" width="60" >
                                    <p:outputLabel value="#{m.valor_baixa}" styleClass="float-right"/>
                                </p:column>

                                <p:column headerText="Taxa" width="30" >
                                    <p:outputLabel value="#{m.taxa}" styleClass="float-right"/>
                                </p:column>

                                <p:column headerText="Ult. Imp" width="30" styleClass="text-center">
                                    <p:commandButton icon="ui-icon-newwin" oncomplete="PF('dlg_ultima_impressao').show()" rendered="#{extratoTelaBean.getUltimaImpressao(m.id)}" action="#{extratoTelaBean.verUltimaImpressão(m.id)}" title="Ver Lista de Impressões" update=":formExtratoTela:i_tbl_impressao" />
                                </p:column>

                                <p:column  width="50" styleClass="text-center" >
                                    <p:commandLink value="Alterar Movimento" action="#{extratoTelaBean.alterarMovimento(m.id)}" rendered="#{m.quitacao ne null}" disabled="#{controleAcessoBean.botaoAlterarMovimento}"/>
                                </p:column>

                                <p:rowExpansion>
                                    <h:panelGrid columns="4" style="height: 40px" styleClass="sbb">
                                        <p:column>
                                            <p:outputLabel value="ID" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.id}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Lote Baixa" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.baixa_id}"/>
                                        </p:column>

                                        <p:column rendered="#{configuracaoBean.resolucao.tipoResolucao.id == 2}">
                                            <p:outputLabel value="CNPJ" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.documento}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Beneficiário" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.beneficiario}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Filial" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.filial}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Usuário" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.usuario_nome}"/>
                                        </p:column>

                                        <p:column>
                                            <p:outputLabel value="Importação" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.importacao}"/>
                                        </p:column>

                                        <p:column  styleClass="text-center">
                                            <p:commandButton icon="ui-icon-comment" value="MENSAGEM BOLETO" action="#{extratoTelaBean.openHistorico(index2)}" onclick="PF('dlg_message_historico').show()" update=":formExtratoTela:id_message_historico" title="MENSAGEM BOLETO" rendered="#{m.servico_tipo ne 'Acordo'}"/>
                                        </p:column>                                        

                                        <p:column>
                                            <p:outputLabel value="Acordo" style="font-weight: bold" rendered="#{not empty m.listMovimentoAcordo}" /><br />
                                            <p:commandLink value="#{m.listMovimentoAcordo[0].acordo.id} (Visualizar)" rendered="#{not empty m.listMovimentoAcordo}"  action="#{extratoTelaBean.setListMovimentosAcordo(m.listMovimentoAcordo)}" onclick="PF('dlg_acordos').show()" update=":formExtratoTelaOpcoes:i_m_a" styleClass="bold font-color-blue" title="Visualizar esta lista"/>
                                        </p:column>

                                        <p:column>
                                            <p:column style="text-align: center; width: 30px" headerText="Recibo" rendered="#{extratoTelaBean.porPesquisa == 'recebidas'}">
                                                <h:commandLink target="#{baixaGeralBean.targetImprimeRecibo(m.id)}" action="#{baixaGeralBean.recibo2Via(m.id)}" rendered="#{m.conta eq 'CAIXA'}" title="Imprimir este Recibo">
                                                    <p:commandButton icon="ui-icon-print" title="Imprimir este Recibo" value="2ª Via de Recibo"/>
                                                </h:commandLink>
                                            </p:column>
                                        </p:column>
                                    </h:panelGrid>

                                    <h:panelGrid columns="4" style="height: 40px" styleClass="sbb">
                                        <p:commandButton value="FORMAS DE PAGTO" update=":formExtratoTela:i_forma_pagto_baixa" onclick="PF('dlg_forma_pagto_baixa').show()" action="#{financeiroCardBean.cardFormaPagamentoBaixa(m.baixa_id)}" title="Ver detalhes" rendered="#{m.baixa_id ne null}"/>
                                    </h:panelGrid>

                                    <h:panelGrid columns="4" style="height: 40px" styleClass="sbb">                                        
                                        <p:column>
                                            <p:outputLabel value="Vencto Original" style="font-weight: bold"/><br />
                                            <p:outputLabel value="#{m.movimento.vencimentoOriginal}"/>
                                        </p:column>
                                    </h:panelGrid>

                                </p:rowExpansion>                                
                            </p:dataTable>

                            <h:panelGrid id="i_panel_valores" columns="7" style="margin-top: 10px">
                                <h:column>
                                    <p:outputLabel value="Núm de Boletos" for="idQntBoletos"/><br />
                                    <p:inputText id="idQntBoletos" size="10" value="#{extratoTelaBean.qntBoletos}" readonly="true" style="font-weight:bold; text-align:center; margin-right: 15px"/>
                                </h:column>

                                <h:column rendered="#{controleAcessoBean.totalValorExtratoTela}">
                                    <p:outputLabel value="Total Recebido " styleClass="fonteExtratoTela" for="idSomarVlRecebido"/> <br />
                                    <p:inputText id="idSomarVlRecebido" size="15" value="#{extratoTelaBean.vlRecebido}" readonly="true" style="font-weight:bold; text-align: right; margin-right: 15px"/>
                                </h:column>

                                <h:column rendered="#{controleAcessoBean.totalValorExtratoTela}">
                                    <p:outputLabel value="Total NÃO Recebido" styleClass="fonteExtratoTela" for="idSomarVlNaoRecebido"/> <br />
                                    <p:inputText id="idSomarVlNaoRecebido" size="15" value="#{extratoTelaBean.vlNaoRecebido}" readonly="true" style="font-weight:bold; text-align: right; margin-right: 15px"/>
                                </h:column>

                                <h:column rendered="#{controleAcessoBean.totalValorExtratoTela}">
                                    <p:outputLabel value="Total Valor" /> <br />
                                    <p:inputText id="idSomarVlTotal" size="15" value="#{extratoTelaBean.vlTotal}" readonly="true" style="font-weight:bold; text-align: right; margin-right: 15px" />
                                </h:column>

                                <h:column>
                                    <p:outputLabel value="Total Taxa" for="idSomarTaxa"/> <br />
                                    <p:inputText id="idSomarTaxa" size="10" value="#{extratoTelaBean.vlTaxa}" readonly="true" style="font-weight:bold; text-align: right; margin-right: 15px" />
                                </h:column>

                                <h:column>
                                    <p:outputLabel value="Total Liquido" for="idSomarVlLiquido"/> <br />
                                    <p:inputText id="idSomarVlLiquido" size="15" value="#{extratoTelaBean.vlLiquido}" readonly="true" style="font-weight:bold; text-align: right; margin-right: 15px" />
                                </h:column>

                                <h:column>
                                    <p:outputLabel value="Liquido - Repasse" for="idSomarVlLiquidoRepasse"/> <br />
                                    <p:inputText id="idSomarVlLiquidoRepasse" size="12" value="#{extratoTelaBean.vlRepasse}" readonly="true" style="font-weight:bold; text-align: right" />
                                </h:column>
                            </h:panelGrid>

                            <p:dialog widgetVar="dlg_alterar_movimento" header="Deseja realmente ALTERAR esse movimento?" resizable="false" modal="true" width="500">
                                <h:panelGrid id="panel_alterar_movimento">
                                    <h:panelGrid columns="3">
                                        <h:column>
                                            <p:outputLabel value="Tipo" /><br />
                                            <p:selectOneMenu value="#{extratoTelaBean.idTipoServicoAlterar}">
                                                <p:ajax event="change" update="@this" global="false"/>
                                                <f:selectItems value="#{extratoTelaBean.listaTipoServicoAlterar}"/>
                                            </p:selectOneMenu>
                                        </h:column>

                                        <h:column>
                                            <p:outputLabel value="Referência" /><br />
                                            <p:inputMask value="#{extratoTelaBean.movimentoAlterar.referencia}" mask="99/9999" style="text-align: center; width: 70px" converter="#{isDateReference}">
                                                <p:ajax event="change" update="@this" global="false"/>
                                            </p:inputMask>
                                        </h:column>

                                        <h:column>
                                            <p:outputLabel value="Vencimento" /><br />
                                            <p:inputMask value="#{extratoTelaBean.movimentoAlterar.vencimento}" mask="99/99/9999" style="text-align: center; width: 100px"  converter="#{isDateString}">
                                                <p:ajax event="change" update="@this" global="false"/>
                                            </p:inputMask>
                                        </h:column>
                                    </h:panelGrid>
                                </h:panelGrid>
                                <f:facet name="footer">
                                    <h:panelGrid columns="2">
                                        <p:commandButton icon="ui-icon-circle-check" value="Alterar" action="#{extratoTelaBean.salvarAlterarMovimento()}" title="Confirma salvar Alteração" update="@form"/>
                                        <p:commandButton icon="ui-icon-circle-close" value="Cancelar" title="Cancelar Alteração" onclick="PF('dlg_alterar_movimento').hide()" global="false"/>
                                    </h:panelGrid>
                                </f:facet>
                            </p:dialog>

                            <p:dialog widgetVar="dlg_ultima_impressao" header="Últimas Impressões desse movimento" resizable="false" modal="true" width="700" position="top">
                                <h:panelGrid id="i_tbl_impressao" columns="2">
                                    <p:tabView prependId="false">
                                        <p:tab title="Interno">
                                            <p:dataTable value="#{extratoTelaBean.listaImpressao}" var="linha" style="width: 100%" emptyMessage="Nenhuma Impressão encontrada!">
                                                <p:column headerText="Impressão" style="text-align: center; width: 85px">
                                                    <h:outputText value="#{linha.impressao}"/>
                                                </p:column> 

                                                <p:column headerText="Vencimento" style="text-align: center; width: 85px">
                                                    <h:outputText value="#{linha.vencimento}"/>
                                                </p:column> 

                                                <p:column headerText="Valor" style="text-align: right; width: 80px">
                                                    <h:outputText value="#{linha.movimento.valorString}"/>
                                                </p:column> 

                                                <p:column headerText="Usuário">
                                                    <h:outputText value="#{linha.usuario.pessoa.nome}"/>
                                                </p:column> 
                                            </p:dataTable>                                            
                                        </p:tab>
                                        <p:tab title="Web">
                                            <p:dataTable value="#{extratoTelaBean.listaImpressaoWeb}" var="impressaoWeb" style="width: 100%" emptyMessage="Nenhuma Impressão encontrada!">
                                                <p:column headerText="Impressão" style="text-align: center; width: 85px">
                                                    <h:outputText value="#{impressaoWeb.data}">
                                                        <f:convertDateTime />
                                                    </h:outputText>
                                                </p:column> 

                                                <p:column headerText="Vencimento" style="text-align: center; width: 85px">
                                                    <h:outputText value="#{impressaoWeb.dtVencimento}">
                                                        <f:convertDateTime />
                                                    </h:outputText>
                                                </p:column> 

                                                <p:column headerText="Horário" style="text-align: center; width: 85px">
                                                    <h:outputText value="#{impressaoWeb.hora}"/>
                                                </p:column> 

                                                <p:column headerText="Valor" style="text-align: right; width: 80px">
                                                    <h:outputText value="#{impressaoWeb.movimento.valorString}"/>
                                                </p:column> 

                                                <p:column headerText="Pessoa">
                                                    <h:outputText value="#{impressaoWeb.pessoa.nome}"/>
                                                </p:column> 
                                            </p:dataTable>                                            

                                        </p:tab>
                                    </p:tabView>
                                </h:panelGrid>

                                <h:panelGrid columns="1">
                                    <p:commandButton icon="ui-icon-circle-check" value="OK" onclick="PF('dlg_ultima_impressao').hide()" global="false"/>
                                </h:panelGrid>
                            </p:dialog>

                            <p:dialog widgetVar="dlg_message_historico" header="Mensagem" resizable="false" modal="true" closeOnEscape="true" visible="#{extratoTelaBean.historicoMovimento != null}" width="600" position="top">
                                <p:ajax event="close" listener="#{extratoTelaBean.closeHistorico}" update=":formExtratoTela:" />
                                <h:panelGroup layout="block" id="id_message_historico">
                                    <p:messages showDetail="true" closable="true" autoUpdate="true"/>  
                                    <h:panelGrid rendered="#{extratoTelaBean.historicoMovimento != null}">
                                        <p:outputLabel value="MENSAGEM CONTRIBUINTE" />
                                        <p:inputTextarea maxlength="2000" value="#{extratoTelaBean.historicoMovimento.historico}" cols="80" addLine="true" rows="5">
                                            <p:ajax event="change" update="@this" global="false"/>
                                        </p:inputTextarea>
                                        <h:column><br /></h:column>
                                        <p:outputLabel value="MENSAGEM BOLETO" />
                                        <p:inputTextarea maxlength="2000" value="#{extratoTelaBean.historicoMovimento.complemento}" cols="80" addLine="true" rows="5">
                                            <p:ajax event="change" update="@this" global="false"/>
                                        </p:inputTextarea>
                                    </h:panelGrid>
                                </h:panelGroup>
                                <f:facet name="footer">
                                    <h:panelGrid columns="2">
                                        <p:commandButton value="Salvar" type="submit" styleClass="ui-confirmdialog-yes" action="#{extratoTelaBean.saveHistorico}" icon="ui-icon-check" update=":formExtratoTela:"/>  
                                        <p:commandButton value="Voltar" type="button" styleClass="ui-confirmdialog-no" onclick="PF('dlg_message_historico').hide()" icon="ui-icon-close"/>       
                                    </h:panelGrid>                                    
                                </f:facet>
                            </p:dialog>                               
                            <p:dialog widgetVar="dlg_forma_pagto_baixa" modal="true" resizable="false" height="400" width="600" header="FORMAS DE PAGAMENTO DA BAIXA">
                                <p:ajax event="close" listener="#{financeiroCardBean.close}"/>  
                                <h:panelGroup layout="block" id="i_forma_pagto_baixa">
                                    <ui:include src="templates/templateFormaPagtoBaixa.xhtml" />
                                </h:panelGroup>
                            </p:dialog>
                        </h:form>

                        <h:form id="formExtratoTelaOpcoes">
                            <p:messages id="i_msg" closable="true" showDetail="true" autoUpdate="true"/>
                            <p:panel styleClass="fundoCinza" header="Opções do Boleto">
                                <h:panelGroup id="i_reativar_bol">
                                    <h:panelGrid columns="13" rendered="#{extratoTelaBean.porPesquisa eq 'excluidos'}">
                                        <p:column>
                                            <br />
                                            <p:commandButton value="Reativar" title="Reativar movimentos selecionados" onclick="PF('i_dlg_reativar').show()" rendered="#{segurancaUtilitariosBean.sessaoUsuario.id == 1}"/>
                                        </p:column>
                                    </h:panelGrid>
                                </h:panelGroup>                                 
                                <h:panelGrid columns="9">
                                    <h:column>
                                        <p:selectBooleanCheckbox value="#{extratoTelaBean.imprimirVerso}" itemLabel="Imprimir Verso" />
                                    </h:column>

                                    <h:column>
                                        <p:commandLink action="#{extratoTelaBean.imprimir}" title="Imprimir Boletos Selecionados" ajax="false" target="_BLANK" >
                                            <p:commandButton icon="ui-icon-print" value="Visualizar" title="Imprimir Boletos Selecionados" ajax="false"/>
                                        </p:commandLink>
                                    </h:column>

                                    <h:column>
                                        <p:commandLink action="#{extratoTelaBean.imprimir(true)}" title="Salvar Boletos Selecionados" ajax="false" target="_BLANK">
                                            <p:commandButton icon="ui-icon-disk" value="Download" title="Salvar boletos selecionados" ajax="false"/>
                                        </p:commandLink>
                                    </h:column>

                                    <h:column>
                                        <p:commandButton icon="ui-icon-print" value="Criar Remessa" title="Gerar Remessa de Boletos" action="#{extratoTelaBean.adicionarRemessa()}"  styleClass="margin-left-max"/>
                                    </h:column>

                                    <h:column>
                                        <p:commandButton icon="ui-icon-close" value="Excluir" title="Excluir Boletos Selecionados" disabled="#{controleAcessoBean.botaoExcluir}" onclick="PF('dlg_excluir').show()" styleClass="margin-left-max"/>
                                    </h:column>

                                    <h:column>
                                        <p:commandButton icon="ui-icon-arrowreturnthick-1-w" value="Estornar" title="Estornar Boletos Selecionados (Apenas Pagos)" disabled="#{controleAcessoBean.botaoEstornarBoleto}" onclick="PF('dlg_estornar').show()" styleClass="margin-left-max"/>
                                    </h:column>

                                    <h:column>
                                        <p:panel styleClass="margin-left-max">
                                            <h:panelGrid columns="3">
                                                <p:commandButton icon="ui-icon-mail-closed" value="Enviar por Email" title="Enviar movimentos por Email (das respectivas empresas)" onclick="PF('dlg_enviar_email').show()"/>
                                                <p:outputLabel value=" para " styleClass="fontePadrao" />
                                                <p:selectOneMenu value="#{extratoTelaBean.tipoEnvio}">
                                                    <p:ajax event="change" update="@this" global="false"/>
                                                    <f:selectItem itemValue="empresa"       itemLabel="Empresa"/>
                                                    <f:selectItem itemValue="contabilidade" itemLabel="Contabilidade"/>
                                                </p:selectOneMenu>                                                                                    
                                            </h:panelGrid>
                                        </p:panel>
                                    </h:column>
                                </h:panelGrid>
                            </p:panel>

                            <p:panel styleClass="fundoCinza margin-top-max" header="Opções do Acordo">
                                <p:outputLabel value="Opções do Acordo" style="font-weight: bold; font-size: 8pt!important"/>
                                <h:panelGrid columns="3">
                                    <h:column>
                                        <p:commandButton icon="ui-icon-close" value="Excluir Acordo" style="margin-right: 15px" title="Excluir Acordos Selecionados" onclick="PF('dlg_acordo').show()" disabled="#{controleAcessoBean.botaoExcluirAcordo}"/>
                                    </h:column>

                                    <h:column>
                                        <p:commandLink action="#{extratoTelaBean.imprimirPlanilha}" title="Planilha Acordo" target="_blank" ajax="false">
                                            <p:commandButton icon="ui-icon-print" value="Planilha Acordo" style="margin-right: 15px" title="Planilha Acordo" ajax="false"/>
                                        </p:commandLink>
                                    </h:column>

                                    <h:column>
                                        <p:commandLink action="#{extratoTelaBean.imprimirPromissoria}" title="Promissória Acordo" target="_blank" ajax="false">
                                            <p:commandButton icon="ui-icon-print" value="Promissória Acordo" title="Promissória Acordo" ajax="false"/>
                                        </p:commandLink>
                                    </h:column>

                                </h:panelGrid>
                            </p:panel>

                            <p:dialog widgetVar="dlg_gerar_remessa" header="Gerador Arquivo Remessa" resizable="false" draggable="false" width="950" position="top" visible="#{extratoTelaBean.visibleModalRemessa}">
                                <p:ajax event="close" update="formExtratoTela" listener="#{extratoTelaBean.fecharModalRemessa}"/>

                                <h:panelGrid id="dlg_gerar_remessa" style="width: 100%">
                                    <p:messages autoUpdate="true" closable="true" showDetail="true" />

                                    <h:panelGrid columns="2">
                                        <p:selectBooleanButton value="#{extratoTelaBean.verListaRemessa}" onLabel="NÃO VER LISTA DE BOLETO" offLabel="VER LISTA DE BOLETO" onIcon="ui-icon-close" offIcon="ui-icon-check" style="margin-right: 15px">
                                            <p:ajax update="dlg_gerar_remessa" />
                                        </p:selectBooleanButton>

                                        <p:outputLabel value="#{extratoTelaBean.contaSelecionada.apelido} - #{extratoTelaBean.contaSelecionada.codCedente} - #{extratoTelaBean.contaSelecionada.contaBanco.banco.banco}" style="font-weight: bold; font-size: 11pt!important; "/>
                                    </h:panelGrid>

                                    <p:separator />

                                    <h:panelGrid rendered="#{extratoTelaBean.verListaRemessa}">
                                        <p:dataTable value="#{extratoTelaBean.listaBoletoRemessa}" var="linha_remessa" emptyMessage="Nenhum Boleto Adicionado" scrollable="true" scrollHeight="350" rowStyleClass="#{linha_remessa.tipo}">
                                            <p:column headerText="#" style="width: 80px; text-align: center">
                                                <h:outputText value="#{linha_remessa.boleto.id}" />
                                            </p:column>

                                            <p:column headerText="Boleto" style="width: 150px; text-align: center">
                                                <h:outputText value="#{linha_remessa.boleto.boletoComposto}" />
                                            </p:column>

                                            <p:column headerText="Pessoa">
                                                <h:outputText value="#{linha_remessa.boleto.pessoa.nome}" />
                                            </p:column>

                                            <p:column headerText="Vencimento" style="width: 80px; text-align: center">
                                                <h:outputText value="#{linha_remessa.boleto.vencimento}" />
                                            </p:column>

                                            <p:column headerText="Status" style="width: 80px; text-align: center">
                                                <h:outputText value="#{linha_remessa.statusRemessa.descricao}" style="font-weight: bold"/>
                                            </p:column>
                                        </p:dataTable>

                                        <h:panelGrid columns="4">
                                            <h:column>
                                                <div style="width: 15px; height: 15px; border:1px solid black;" class="tblExtratoTelaT1"></div>
                                            </h:column>
                                            <h:column>
                                                <b>Adicionados Automáticamente</b>
                                            </h:column>

                                            <h:column>
                                                <div style="width: 15px; height: 15px; border:1px solid black;"></div>
                                            </h:column>
                                            <h:column>
                                                <b>Adicionados por mim</b>
                                            </h:column>
                                        </h:panelGrid>

                                    </h:panelGrid>

                                    <h:panelGrid columns="2">
                                        <h:column>
                                            <p:outputLabel value="Quantidade de Boletos: " /><p:outputLabel value="#{extratoTelaBean.listaBoletoRemessa.size()}" style="font-weight: bold"/>
                                        </h:column>

                                        <h:column>
                                            <p:outputLabel value="Limite médio de Arquivo: " /><p:outputLabel value="2000" style="font-weight: bold"/>
                                        </h:column>
                                        <!--
                                        <h:column>
                                            <p:outputLabel value="De um total de " /><p:outputLabel value="# {extratoTelaBean.listaBoletoRemessaCount}" style="font-weight: bold"/><p:outputLabel value=" boletos" />
                                        </h:column>
                                        -->
                                    </h:panelGrid>

                                    <h:panelGrid columns="2">
                                        <p:commandButton icon="ui-icon-check" value="GERAR REMESSA" action="#{extratoTelaBean.imprimirRemessa()}" ajax="false"/>
                                        <p:commandButton icon="ui-icon-circle-close" value="SAIR E CANCELAR REMESSA" title="Cancelar Geração de Arquivo Remessa" onclick="PF('dlg_gerar_remessa').hide()"/>
                                    </h:panelGrid>
                                </h:panelGrid>
                            </p:dialog>

                            <p:dialog widgetVar="dlg_opcao_remessa" header="Opções da Remessa Selecionada" resizable="false" width="450" modal="true">

                                <h:panelGrid columns="1">
                                    <p:outputLabel value="O que fazer com os boletos selecionados?" style="font-size: 12pt!important; font-weight: bold"/>
                                </h:panelGrid>
                                <br />
                                <h:panelGrid columns="3">
                                    <p:commandButton icon="ui-icon-plus" value="REGISTRAR" title="Registrar" onclick="PF('dlg_opcao_remessa').hide()" action="#{extratoTelaBean.adicionarRemessa('registrar')}"/>
                                    <p:commandButton icon="ui-icon-arrowthick-1-s" value="BAIXAR NO BANCO" title="Baixar no Banco" onclick="PF('dlg_opcao_remessa').hide()" action="#{extratoTelaBean.adicionarRemessa('baixar_banco')}"/>
                                    <p:commandButton icon="ui-icon-circle-close" value="FECHAR" title="Cancelar Geração" onclick="PF('dlg_opcao_remessa').hide()"/>
                                </h:panelGrid>

                            </p:dialog>

                            <p:dialog widgetVar="dlg_excluir" header="Excluir Movimentos" resizable="false" modal="true" width="400">
                                <h:panelGrid>
                                    <p:outputLabel value="Deseja realmente excluir esses movimentos?" style="font-weight: bold; font-size: 12pt!important"/>
                                </h:panelGrid>
                                <p:messages id="i_msg_excluir" closable="true" showDetail="true"/>
                                <h:panelGrid style="width: 100%"> 
                                    <p:outputLabel value="Digite o motivo para exclusão"/>
                                    <p:inputTextarea value="#{extratoTelaBean.historico}" rows="5" style="width: 100%"> 

                                    </p:inputTextarea>
                                </h:panelGrid>

                                <h:panelGrid columns="2">
                                    <p:commandButton icon="ui-icon-circle-check" value="Sim" action="#{extratoTelaBean.inativarBoleto}" title="Excluir boletos selecionados" update="i_msg_excluir"/>
                                    <p:commandButton icon="ui-icon-circle-close" value="Não" title="Cancelar exclusão" onclick="PF('dlg_excluir').hide()" global="false"/>
                                </h:panelGrid>
                            </p:dialog>

                            <p:dialog widgetVar="dlg_estornar" header="Estornar Movimentos" resizable="false" modal="true" width="400">
                                <h:panelGrid>
                                    <p:outputLabel value="Deseja realmente ESTORNAR esses movimentos?" style="font-weight: bold; font-size: 12pt!important"/>
                                </h:panelGrid>
                                <p:messages id="i_msg_estornar" closable="true" showDetail="true"/>
                                <h:panelGrid style="width: 100%">
                                    <p:outputLabel value="Digite um motivo para o Estorno" /><br />
                                    <p:inputTextarea value="#{extratoTelaBean.motivoEstorno}" style="width: 100%" rows="2"/>
                                </h:panelGrid>
                                <br />
                                <h:panelGrid columns="2">
                                    <p:commandButton icon="ui-icon-circle-check" value="Sim" action="#{extratoTelaBean.estornarBaixa()}" title="Estornar boletos selecionados" update="i_msg_estornar"/>
                                    <p:commandButton icon="ui-icon-circle-close" value="Não" title="Cancelar Estorno" onclick="PF('dlg_estornar').hide()" global="false"/>
                                </h:panelGrid>
                            </p:dialog>

                            <p:dialog widgetVar="dlg_enviar_email" header="Enviar Email" resizable="false" modal="true" width="400">
                                <h:panelGrid>
                                    <p:outputLabel value="Deseja realmente ENVIAR esses movimentos por EMAIL?" style="font-weight: bold; font-size: 12pt!important"/>
                                </h:panelGrid>
                                <p:messages id="i_msg_enviar_email" closable="true" showDetail="true"/>

                                <h:panelGrid columns="2">
                                    <p:commandButton icon="ui-icon-circle-check" value="Sim" action="#{extratoTelaBean.enviarEmail()}" title="Enviar boletos selecionados" update="i_msg_enviar_email"/>
                                    <p:commandButton icon="ui-icon-circle-close" value="Não" title="Cancelar Envio de Email" onclick="PF('dlg_enviar_email').hide()" global="false"/>
                                </h:panelGrid>
                            </p:dialog>

                            <p:dialog widgetVar="dlg_acordo" header="Excluir Acordos" resizable="false" modal="true" width="400">
                                <h:panelGrid>
                                    <p:outputLabel value="Deseja realmente EXCLUIR esses acordos?" style="font-weight: bold; font-size: 12pt!important"/>
                                </h:panelGrid>

                                <p:messages id="i_msg_acordo" closable="true" showDetail="true"/>

                                <h:panelGrid columns="2">
                                    <p:commandButton icon="ui-icon-circle-check" value="Sim" action="#{extratoTelaBean.excluirAcordo()}" title="Excluir acordos selecionados" update="i_msg_acordo"/>
                                    <p:commandButton icon="ui-icon-circle-close" value="Não" title="Cancelar exclusão de Acordos" onclick="PF('dlg_acordo').hide()" global="false"/>
                                </h:panelGrid>
                            </p:dialog>

                            <p:dialog widgetVar="dlg_acordos" header="Lista de acordos" resizable="false" modal="true" width="800" height="300">
                                <h:panelGroup id="i_m_a" layout="block">
                                    <p:dataTable value="#{extratoTelaBean.listMovimentosAcordo}" var="movimentoAcordo" scrollHeight="250" scrollable="true">
                                        <p:column headerText="Referência" styleClass="text-center">
                                            #{movimentoAcordo.referencia}
                                        </p:column>
                                        <p:column headerText="Valor" styleClass="text-center">
                                            #{movimentoAcordo.valorString}
                                        </p:column>
                                        <p:column headerText="Multa" styleClass="text-center">
                                            #{movimentoAcordo.multaString}
                                        </p:column>
                                        <p:column headerText="Juros" styleClass="text-center">
                                            #{movimentoAcordo.jurosString}
                                        </p:column>
                                        <p:column headerText="Correção" styleClass="text-center">
                                            #{movimentoAcordo.correcaoString}
                                        </p:column>
                                        <p:column headerText="Desconto" styleClass="text-center">
                                            #{movimentoAcordo.descontoString}
                                        </p:column>
                                        <p:column headerText="Total" styleClass="text-center">
                                            #{movimentoAcordo.totalString}
                                        </p:column>
                                    </p:dataTable>
                                </h:panelGroup>
                                <f:facet name="footer">
                                    <p:commandButton icon="ui-icon-circle-close" value="Fechar" title="Fechar" onclick="PF('dlg_acordos').hide()" global="false"/>                                    
                                </f:facet>
                            </p:dialog>
                            <p:dialog widgetVar="i_dlg_reativar" header="Deseja reativar estes Movimentos" resizable="false" width="400" modal="true">
                                <h:panelGrid>
                                    <p:outputLabel value="Deseja realmente REATIVAR esse movimento?" style="font-size: 11pt!important"/>
                                </h:panelGrid>

                                <h:panelGrid style="width: 100%">
                                    <p:outputLabel value="Digite um motivo para reativação" style="font-size: 10pt!important; font-weight: bold"/>
                                    <p:inputTextarea value="#{extratoTelaBean.motivoReativacao}" style="width: 100%"/>
                                </h:panelGrid>

                                <p:commandButton value="Sim"      type="submit" styleClass="ui-confirmdialog-yes" action="#{extratoTelaBean.reativarMovimentos()}" update=":formExtratoTelaOpcoes: :formExtratoTela:" onclick="PF('i_dlg_reativar').hide()" style="clear: both; float: left" icon="ui-icon-check"/>  
                                <p:commandButton value="Cancelar" type="button" styleClass="ui-confirmdialog-no" onclick="PF('i_dlg_reativar').hide()" style="float: left" icon="ui-icon-close"/>       
                            </p:dialog>

                        </h:form>

                    </p:panel>


                    <h:form id="formExtratoTelaAlteraVencimento">
                        <p:dialog widgetVar="dlg_alterar_vencimento" header="Alterar data de Vencimento" resizable="false" modal="true" width="400">
                            <h:panelGrid>
                                <p:outputLabel value="Confirma alteração do vencimento deste acordo?" style="font-weight: bold; font-size: 12pt!important"/>
                            </h:panelGrid>
                            <p:messages id="i_msg_vencimento" closable="true" showDetail="true"/>
                            <h:panelGrid style="margin-top: 20px; clear: both" columns="2" id="i_vo">
                                <h:column>
                                    <p:outputLabel value="Vencimento Anterior"/><br />
                                    <p:inputText value="#{extratoTelaBean.dataAntiga}" readonly="true" style="margin-right: 50px; width: 100px; font-weight: bold; text-align: center"/>
                                </h:column>

                                <h:column>
                                    <p:outputLabel value="Digite o novo Vencimento" /><br />
                                    <p:inputMask id="i_nova_data" value="#{extratoTelaBean.dataNova}" mask="99/99/9999" style="width: 100px; text-align: center" converter="#{isDateString}">
                                        <p:ajax event="change" update="@this" global="false"/>
                                    </p:inputMask>
                                    <p:focus for="i_nova_data" />
                                </h:column>
                            </h:panelGrid>
                            <f:facet name="footer">                                
                                <h:panelGrid columns="3" cellspacing="5">
                                    <p:commandButton value="OK" action="#{extratoTelaBean.atualizarData}" update="i_msg_vencimento"/>
                                    <p:commandButton value="Vencto Original: " title="Voltar Vencimento Original" icon="ui-icon-arrowreturnthick-1-w" action="#{extratoTelaBean.vencimentoOritinal}" update="i_msg_vencimento"/>
                                    <h:outputLabel value="#{extratoTelaBean.movimentoVencimento.vencimentoOriginal}" styleClass="font-color-red bold"/>
                                </h:panelGrid>
                            </f:facet>
                        </p:dialog>
                    </h:form>
                </f:view>
                <!-- FINALIZA div wrap main -->
            </div>
        </div>
        <!-- FINALIZA div wrap main -->

        <div id="footerx">
            <f:subview id="footer">
                <ui:include src="templates/templateFooter.xhtml"/>
            </f:subview>
        </div>                
    </h:body>
</ui:composition>