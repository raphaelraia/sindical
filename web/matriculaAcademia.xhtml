<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui">    
    <h:head>
        <title>Matricula Academia</title>
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
        <link rel="shortcut icon" href="#{facesContext.externalContext.requestContextPath}/Imagens/favicon.ico"/>  
        <style type="text/css">
            .ui-widget-content .ui-inputfield{ padding: 8px!important;} 
            .ui-button { padding: 3px!important; }            
        </style> 
    </h:head>    
    <h:body>
        <f:subview id="header">
            <ui:include src="templates/templatePrime.xhtml"/>
        </f:subview>
        <f:view>
            <f:metadata>
            </f:metadata>
            <ui:include src="templates/templateAcessoFilialComCaixa.xhtml" />
            <ui:include src="templates/templateStatus.xhtml" />            
            <ui:include src="templates/templatePhotoCapture.xhtml" />
            <ui:include src="templates/templatePhotoUpload.xhtml" />            
            <p:panel style="margin: 0 auto; border: 0; width: #{configuracaoBean.resolucao.tipoResolucao.tamanho}">
                <p:outputLabel value="Matrícula Academia" styleClass="fonteHeader"/>
                <div class="clear"></div>
                <h:outputScript name="tradutor_primefaces.js" library="js" /> 
                <p:growl id="id_mensagem_growl" showDetail="true" showSummary="true"/> 
                <h:form id="form_matricula_academia">                  
                    <c:set scope="request" var="object" value="${matriculaAcademiaBean.matriculaAcademia}"/>
                    <h:outputText value="#{genericaMensagem.getHtmlMessage('warn', 'IMPORTANTE:', 'CADASTRO INATIVO')}" escape="false" rendered="#{!matriculaAcademiaBean.matriculaAcademia.servicoPessoa.ativo}"/>
                    <h:outputText value="#{genericaMensagem.getHtmlMessage('fatal', 'MENSAGEM DE BLOQUEIO (Aluno):', matriculaAcademiaBean.aluno.pessoa.pessoaComplemento.obsAviso)}" escape="false" rendered="#{not empty matriculaAcademiaBean.aluno.pessoa.pessoaComplemento.obsAviso}" />
                    <h:outputText value="#{genericaMensagem.getHtmlMessage('fatal', 'MENSAGEM DE BLOQUEIO (Responsável):', matriculaAcademiaBean.matriculaAcademia.servicoPessoa.cobranca.pessoaComplemento.obsAviso)}" escape="false" rendered="#{not empty matriculaAcademiaBean.matriculaAcademia.servicoPessoa.cobranca.pessoaComplemento.obsAviso}" />
                    <h:panelGrid columns="3" style="width: 100%">
                    </h:panelGrid>
                    <h:panelGroup id="id_panel_cadastro">
                        <h:panelGrid>
                            <h:column>
                                <p:messages closable="true" showDetail="true" autoUpdate="true"/>
                                <p:panel style="border: 1px solid #ff9999; margin-bottom: 15px!important" rendered="#{matriculaAcademiaBean.matriculaAcademiaAntiga.id ne -1}" styleClass="margin-top" >
                                    <f:facet name="header">
                                        <h:outputLabel value="TROCA DE MODALIDADE" styleClass="bold font-color-red font-size-14"/>                                            
                                    </f:facet>
                                    <h:panelGrid columns="1">
                                        <h:column>
                                            <h:outputLabel value="Nome" style="color: black;"/><br />
                                            <h:outputLabel value="#{matriculaAcademiaBean.matriculaAcademiaAntiga.servicoPessoa.pessoa.nome}" style="color: black; font-weight: bold;"/>                                        
                                        </h:column>
                                    </h:panelGrid>

                                    <h:panelGrid columns="1">
                                        <h:column>
                                            <h:outputLabel value="Modalidade Anterior" style="color: black;"/><br />
                                            <h:outputLabel value="#{matriculaAcademiaBean.matriculaAcademiaAntiga.servicoPessoa.servicos.descricao}" style="color: black; font-weight: bold;"/>                                        
                                        </h:column>
                                    </h:panelGrid>

                                    <h:panelGrid columns="1">
                                        <h:column>
                                            <h:outputLabel value="Valor Liquido Anterior" style="color: black;"/><br />
                                            <h:outputLabel value="#{matriculaAcademiaBean.valorLiquidoAntigo}" style="color: black; font-weight: bold;"/>                                        
                                        </h:column>
                                    </h:panelGrid>
                                    <f:facet name="actions">
                                        <p:commandButton value="CANCELAR" icon="ui-icon-close" action="#{matriculaAcademiaBean.cancelarTrocaMatricula()}" update="@form" styleClass="float-right bold font-color-red" title="DESFAZER AS ALTERAÇÕES"/>
                                    </f:facet>
                                </p:panel>                            
                                <p:panel>
                                    <h:panelGrid columns="2" cellpadding="3" width="830" columnClasses="verticalAlignTop,verticalAlignTop">
                                        <h:column>
                                            <h:panelGrid columns="2" cellpadding="3" width="820">
                                                <p:outputLabel value="Emissão:" />
                                                <h:column>
                                                    <h:panelGrid id="i_panel_dia_vencimento" columns="6">
                                                        <p:inputMask value="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.emissao}" mask="99/99/9999" size="8" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" converter="#{isDateString}">
                                                            <p:ajax event="blur" update="id_grid_validade" />
                                                        </p:inputMask>
                                                        <p:outputLabel value="Vencimento para Boleto Bancário:" styleClass="margin-left-max" />
                                                        <h:column rendered="#{matriculaAcademiaBean.aluno.id == -1}"></h:column>
                                                        <p:selectOneMenu value="#{matriculaAcademiaBean.idDiaVencimento}" disabled="true" id="i_l_m">
                                                            <f:selectItems value="#{matriculaAcademiaBean.listaDiaVencimento}" />
                                                        </p:selectOneMenu>
                                                        <p:commandLink value="Alterar dia Vencimento" onclick="PF('dlg_alterar_dia_vencto').show()" rendered="#{matriculaAcademiaBean.aluno.id != -1}"/>
                                                        <p:outputLabel value="Vigoração:" styleClass="margin-left-max"/>
                                                        <p:inputMask value="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.referenciaVigoracao}" size="5" mask="99/9999" converter="#{isDateReference}">
                                                            <p:ajax event="blur" update="@this" />
                                                        </p:inputMask>
                                                        <p:dialog id="id_alterar_dia_vencto"  widgetVar="dlg_alterar_dia_vencto" modal="true" header="Selecione o dia" resizable="false">
                                                            <p:selectOneMenu value="#{matriculaAcademiaBean.idDiaVencimento}">
                                                                <p:ajax event="change" update="@this i_l_m :form_matricula_academia:" oncomplete="PF('dlg_alterar_dia_vencto').hide()" listener="#{matriculaAcademiaBean.salvarData}"/>
                                                                <f:selectItems value="#{matriculaAcademiaBean.listaDiaVencimento}"/>
                                                            </p:selectOneMenu>
                                                        </p:dialog>
                                                        <p:dialog widgetVar="dlg_dv" header="Alterar dia de vencimento?" modal="true" width="300">
                                                            <center>
                                                                <h:panelGrid columns="2">
                                                                    <h:outputLabel value="Dia do Vencimento: " />
                                                                    <h:selectOneMenu>
                                                                        <p:ajax event="change" update="@this i_panel_dia_vencimento" oncomplete="PF('dlg_dv').hide()" />
                                                                        <f:selectItem itemValue="1" itemLabel="01"/>
                                                                        <f:selectItem itemValue="2" itemLabel="02"/>
                                                                        <f:selectItem itemValue="3" itemLabel="03"/>
                                                                        <f:selectItem itemValue="4" itemLabel="04"/>
                                                                        <f:selectItem itemValue="5" itemLabel="05"/>
                                                                        <f:selectItem itemValue="6" itemLabel="06"/>
                                                                        <f:selectItem itemValue="7" itemLabel="07"/>
                                                                        <f:selectItem itemValue="8" itemLabel="08"/>
                                                                        <f:selectItem itemValue="9" itemLabel="09"/>
                                                                        <f:selectItem itemValue="10" itemLabel="10"/>
                                                                        <f:selectItem itemValue="11" itemLabel="11"/>
                                                                        <f:selectItem itemValue="12" itemLabel="12"/>
                                                                        <f:selectItem itemValue="13" itemLabel="13"/>
                                                                        <f:selectItem itemValue="14" itemLabel="14"/>
                                                                        <f:selectItem itemValue="15" itemLabel="15"/>
                                                                        <f:selectItem itemValue="16" itemLabel="16"/>
                                                                        <f:selectItem itemValue="17" itemLabel="17"/>
                                                                        <f:selectItem itemValue="18" itemLabel="18"/>
                                                                        <f:selectItem itemValue="19" itemLabel="19"/>
                                                                        <f:selectItem itemValue="20" itemLabel="20"/>
                                                                        <f:selectItem itemValue="21" itemLabel="21"/>
                                                                        <f:selectItem itemValue="22" itemLabel="22"/>
                                                                        <f:selectItem itemValue="23" itemLabel="23"/>
                                                                        <f:selectItem itemValue="24" itemLabel="24"/>
                                                                        <f:selectItem itemValue="25" itemLabel="25"/>
                                                                        <f:selectItem itemValue="26" itemLabel="26"/>
                                                                        <f:selectItem itemValue="27" itemLabel="27"/>
                                                                        <f:selectItem itemValue="28" itemLabel="28"/>
                                                                        <f:selectItem itemValue="29" itemLabel="29"/>
                                                                        <f:selectItem itemValue="30" itemLabel="30"/>
                                                                        <f:selectItem itemValue="31" itemLabel="31"/>
                                                                    </h:selectOneMenu>
                                                                </h:panelGrid>
                                                            </center>
                                                        </p:dialog>
                                                    </h:panelGrid>
                                                </h:column>
                                                <p:commandButton icon="ui-icon-search" value="Aluno" action="#{chamadaPaginaBean.pesquisa('pesquisaPessoaFisica', 'pesquisaFisicaTipo', 'aluno')}" title="Pesquisar aluno" id="idPesquisarAluno"  disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" />
                                                <h:column>
                                                    <p:outputLabel value="Pesquisar um aluno" style="border-bottom: 1px dashed #ECF3FE" rendered="#{matriculaAcademiaBean.aluno.pessoa.id == -1}" />
                                                    <p:commandLink value="#{matriculaAcademiaBean.aluno.pessoa.nome}" rendered="#{matriculaAcademiaBean.aluno.pessoa.id != -1}" title="Ver detalhes" onclick="PF('dlg_pessoa_fisica_card').show()" update="i_pessoa_fisica_card" action="#{pessoaCardBean.cardFisica(matriculaAcademiaBean.aluno.pessoa.id)}"/>
                                                </h:column>
                                                <h:column />
                                            </h:panelGrid>
                                            <h:outputText value="#{genericaMensagem.getHtmlMessage('success', ('').concat('Categoria: ').concat(matriculaAcademiaBean.socios.matriculaSocios.categoria.categoria).concat(' - Matrícula: ').concat(matriculaAcademiaBean.socios.matriculaSocios.nrMatricula).concat(' - Parentesco: ').concat(matriculaAcademiaBean.socios.parentesco.parentesco))}" rendered="#{matriculaAcademiaBean.socios.id != -1}" escape="false"/>
                                            <h:panelGrid columns="2" cellpadding="3" width="820">
                                                <p:outputLabel value="Responsável:" />
                                                <h:column>
                                                    <h:panelGrid columns="3">
                                                        <p:commandLink id="idResp" value="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.cobranca.nome}" onclick="PF('dlg_pessoa_card').show()" update="i_pessoa_card" action="#{pessoaCardBean.cardPessoa(matriculaAcademiaBean.matriculaAcademia.servicoPessoa.cobranca.id)}" title="Ver detalhes" />
                                                        <p:commandButton value="Pesquisar / Alterar Responsável" onclick="PF('dlg_painel_trocar_responsavel').show();" type="button" icon="ui-icon-search" rendered="false" styleClass="margin-left-max" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" />
                                                        <p:commandButton value="Pesquisar / Alterar Responsável" action="#{chamadaPaginaBean.pesquisaPessoa()}" icon="ui-icon-search" rendered="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.pessoa.id != -1 and matriculaAcademiaBean.socio == ''}" styleClass="margin-left-max" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" actionListener="#{matriculaAcademiaBean.pesquisaFisica('responsavel')}"/>
                                                        <h:column rendered="#{matriculaAcademiaBean.sociosCobranca.id != -1}">
                                                            <p:selectBooleanCheckbox value="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.descontoFolha}" styleClass="margin-left-max" itemLabel="Desconto em folha" />
                                                        </h:column>
                                                    </h:panelGrid>
                                                </h:column>
                                                <p:outputLabel value="Modalidade:" />
                                                <p:selectOneMenu value="#{matriculaAcademiaBean.idModalidade}" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" style="width: 690px">
                                                    <p:ajax event="change" update="@this id_panel_grid_calcula id_grid_periodo_grade i_panel_dia_vencimento i_parceiros i_vagas_1 i_vagas_2" listener="#{matriculaAcademiaBean.listener('recalcular1')}"/>
                                                    <f:selectItems value="#{matriculaAcademiaBean.listaModalidades}"/>
                                                </p:selectOneMenu>                                                        
                                                <h:column rendered="false">
                                                    <h:panelGroup id="i_vagas_1">
                                                        <h:panelGrid columns="3" rendered="#{matriculaAcademiaBean.quantidadeVagas ne null}">
                                                            <p:outputLabel value="Vagas:" />
                                                            <p:outputLabel value="#{matriculaAcademiaBean.quantidadeVagas}"  styleClass="bold"/>
                                                        </h:panelGrid>
                                                    </h:panelGroup>
                                                </h:column>
                                                <h:column rendered="false">
                                                    <h:panelGroup id="i_vagas_2">
                                                        <h:panelGrid columns="3" rendered="#{matriculaAcademiaBean.quantidadeVagas ne null}">
                                                            <p:outputLabel value="Disponiveis:" styleClass="margin-left-max"/>
                                                            <p:outputLabel value="#{matriculaAcademiaBean.quantidadeDisponiveis}"  styleClass="bold"/>
                                                        </h:panelGrid>                                                        
                                                    </h:panelGroup>
                                                </h:column>
                                                <h:column>
                                                    <h:panelGroup layout="block" rendered="#{matriculaAcademiaBean.socios.id == -1 and matriculaAcademiaBean.aluno.pessoa.id ne -1}">
                                                        <p:outputLabel value="Parceiro: " />
                                                    </h:panelGroup>
                                                </h:column>
                                                <h:column>
                                                    <h:panelGroup layout="block" rendered="#{matriculaAcademiaBean.socios.id == -1 and matriculaAcademiaBean.aluno.pessoa.id ne -1}" id="i_parceiros">
                                                        <p:selectOneMenu autoWidth="false" value="#{matriculaAcademiaBean.idParceiro}" style="width: 690px" filter="true" filterMatchMode="startsWith" disabled="#{matriculaAcademiaBean.listParceiro.size() == 1 or matriculaAcademiaBean.desabilitaCamposMovimento}">
                                                            <p:ajax event="change" update="@this id_panel_grid_calcula id_grid_periodo_grade i_panel_dia_vencimento" listener="#{matriculaAcademiaBean.listener('descontoServicoEmpresa')}"/>
                                                            <f:selectItems value="#{matriculaAcademiaBean.listParceiro}"/>
                                                        </p:selectOneMenu>
                                                    </h:panelGroup>
                                                </h:column>
                                            </h:panelGrid>
                                        </h:column>
                                        <h:column>
                                            <p:panel header="Foto Aluno" rendered="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.pessoa.id != -1}" id="i_photo_cam">
                                                <p:graphicImage name="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.pessoa.fotoResource}" cache="false" width="130"/>
                                                <h:panelGrid columns="2" style="width: 100%" columnClasses="text-center" styleClass="margin-top-max">
                                                    <p:commandButton icon="photocam" value="Capturar Foto" action="matriculaAcademia" actionListener="#{photoCapture.openAndSave(matriculaAcademiaBean.matriculaAcademia.servicoPessoa.pessoa, 'form_matricula_academia')}" title="Capturar Foto" global="false" />
                                                    <br />
                                                    <p:commandButton icon="ui-icon-arrowthick-1-n" value="Enviar Foto" action="#{photoUpload.openAndSave(matriculaAcademiaBean.matriculaAcademia.servicoPessoa.pessoa, 'form_matricula_academia')}" title="Enviar Foto" global="false" />
                                                </h:panelGrid>
                                            </p:panel>
                                        </h:column>
                                    </h:panelGrid>
                                    <h:panelGroup layout="block">
                                        <p:messages closable="true" showDetail="true"/>
                                        <p:panel header="Período / Grade">
                                            <h:panelGrid columns="3" id="id_grid_periodo_grade">
                                                <p:selectOneMenu value="#{matriculaAcademiaBean.idPeriodoGrade}" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" style="width: 940px;">
                                                    <p:ajax event="change" update="@this id_panel_grid_calcula id_grid_periodo_grade id_grid_validade i_panel_dia_vencimento" listener="#{matriculaAcademiaBean.recalcular2}"/>
                                                    <f:selectItems value="#{matriculaAcademiaBean.listaPeriodosGrade}"/>
                                                </p:selectOneMenu>                                            
                                            </h:panelGrid>                                        
                                            <h:panelGrid columns="5" styleClass="margin-top-max" id="id_grid_validade">
                                                <p:outputLabel value="Validade:" rendered="#{not empty matriculaAcademiaBean.dataValidade}" />
                                                <p:inputText value="#{matriculaAcademiaBean.dataValidade}" readonly="true" styleClass="input-text-min text-center font-size-12 bold bg-yellow-ligth" rendered="#{!matriculaAcademiaBean.dataValidade.equals('')}" />
                                                <p:outputLabel value="Número parcelas: " style="font-weight: bold;" rendered="false"/>
                                                <p:column rendered="false">
                                                    <p:spinner value="#{matriculaAcademiaBean.matriculaAcademia.numeroParcelas}"  min="0" max="#{matriculaAcademiaBean.matriculaAcademia.academiaServicoValor.numeroParcelas}" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" rendered="#{!matriculaAcademiaBean.ocultaParcelas}" />
                                                    <p:outputLabel value="0" rendered="#{matriculaAcademiaBean.ocultaParcelas}" />
                                                </p:column>
                                            </h:panelGrid>
                                        </p:panel>
                                    </h:panelGroup>
                                    <h:panelGroup id="id_panel_grid_calcula" layout="block" styleClass="margin-top">
                                        <p:panel>
                                            <f:facet name="header">
                                                <h:panelGrid columns="2" cellpadding="5">
                                                    <h:column>
                                                        <p:selectBooleanCheckbox value="#{matriculaAcademiaBean.taxa}" itemLabel="Cobrar taxa" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" >
                                                            <p:ajax event="change" update="id_panel_grid_calcula" />
                                                        </p:selectBooleanCheckbox>                                                    
                                                    </h:column>
                                                    <h:column>
                                                        <p:selectBooleanCheckbox rendered="#{!matriculaAcademiaBean.ocultaBotaoTarifaCartao}" value="#{matriculaAcademiaBean.taxaCartao}" itemLabel="Cartão Social (Taxa)" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}">
                                                            <p:ajax event="change" update="id_panel_grid_calcula" />
                                                        </p:selectBooleanCheckbox>
                                                    </h:column>
                                                </h:panelGrid>                                                    
                                            </f:facet>
                                            <h:panelGrid columns="1">
                                                <h:column>
                                                    <h:panelGrid columns="12" cellpadding="1">
                                                        <h:column>
                                                            <h:panelGrid>
                                                                <p:outputLabel value="VALOR (R$):" styleClass="margin-top-max"/>
                                                                <p:inputText value="#{matriculaAcademiaBean.valor}" readonly="true" size="8"  styleClass="text-right"/>
                                                            </h:panelGrid>
                                                        </h:column>
                                                        <h:column>
                                                            <h:panelGrid>
                                                                <p:outputLabel value="DESCONTO (R$):" />
                                                                <p:inputText value="#{matriculaAcademiaBean.descontoString}" size="8" readonly="#{matriculaAcademiaBean.listaMovimentos.size() > 0}" converter="#{toCurrency}"  styleClass="text-right" disabled="#{controleAcessoBean.verificarPermissao('desconto_matricula_academia', 3)}" title="DESCONTO MATRÍCULA ACADEMIA">
                                                                    <p:ajax event="blur" listener="#{matriculaAcademiaBean.calculoDesconto()}" update="@this, id_panel_grid_calcula" />
                                                                </p:inputText>
                                                            </h:panelGrid>
                                                        </h:column>
                                                        <h:column>
                                                            <h:panelGrid>
                                                                <p:outputLabel value="TAXA (R$):" rendered="#{matriculaAcademiaBean.taxa}"/>
                                                                <p:inputText value="#{matriculaAcademiaBean.valorTaxa}" rendered="#{matriculaAcademiaBean.taxa}" readonly="true" size="5"/>
                                                            </h:panelGrid>
                                                        </h:column>
                                                        <h:column rendered="#{matriculaAcademiaBean.taxaCartao}">
                                                            <h:panelGrid>
                                                                <h:column>
                                                                    <p:outputLabel value="TAXA CARTÃO (R$)" />
                                                                </h:column>
                                                                <h:column>
                                                                    <p:inputText value="#{matriculaAcademiaBean.valorCartao}" readonly="true" size="5"/>
                                                                </h:column>
                                                            </h:panelGrid>
                                                        </h:column>                                                                
                                                        <h:column>                                                                
                                                            <h:panelGrid>
                                                                <p:outputLabel value="DIA DO VENCTO: " />
                                                                <p:selectOneMenu value="#{matriculaAcademiaBean.idDiaParcela}" disabled="true">
                                                                    <f:selectItems value="#{matriculaAcademiaBean.listaDiaParcela}" />
                                                                </p:selectOneMenu>
                                                            </h:panelGrid>                                                
                                                        </h:column>                                                                
                                                    </h:panelGrid>
                                                </h:column>
                                            </h:panelGrid>
                                            <f:facet name="footer">
                                                <h:panelGrid columns="2" cellpadding="1">
                                                    <p:outputLabel value="VALOR LÍQUIDO (R$):" styleClass="font-size-12 bold font-color-red"/>
                                                    <p:inputText value="#{matriculaAcademiaBean.valorLiquido}" readonly="true" id="id_valor_liquido" styleClass="input-text-med text-center font-size-12 bold bg-yellow-ligth" />
                                                </h:panelGrid>
                                            </f:facet>
                                        </p:panel>
                                    </h:panelGroup>
                                </p:panel>
                                <h:panelGrid id="id_panel_grid_movimento" styleClass="margin-top-max" rendered="#{matriculaAcademiaBean.listaMovimentos.size() != 0}">
                                    <p:dataTable value="#{matriculaAcademiaBean.listaMovimentos}" var="linha" rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}" emptyMessage="Nenhum movimento gerado">
                                        <f:facet name="header">Movimentos gerados</f:facet>
                                        <p:column headerText="Vencimento">
                                            <h:outputText value="#{linha.vencimento}"  />
                                        </p:column>
                                        <p:column headerText="Parcela" styleClass="text-center">
                                            <h:outputText value="Vista" rendered="#{linha.quantidade == 0}"/>
                                            <h:outputText value="#{linha.quantidade}" rendered="#{linha.quantidade != 0}"/>
                                        </p:column>
                                        <p:column headerText="Valor">
                                            <h:outputText value="#{linha.valorString}" />
                                        </p:column>
                                        <p:column headerText="Tipo Serviço" styleClass="text-center">
                                            <h:outputText value="#{linha.tipoServico.descricao}"/>
                                        </p:column>
                                        <p:column headerText="Operador" styleClass="text-center">
                                            <h:outputText value="#{linha.baixa.usuario.pessoa.nome}"/>
                                        </p:column>
                                        <p:column headerText="Quitação" styleClass="text-center">
                                            <h:outputText value="#{linha.baixa.baixa}"/>
                                        </p:column>
                                    </p:dataTable>
                                </h:panelGrid>
                            </h:column>
                        </h:panelGrid>
                        <f:facet name="header">
                            <h:outputLabel value="#{matriculaAcademiaBean.mensagemInadinplente}" rendered="#{not empty matriculaAcademiaBean.mensagemInadinplente}" styleClass="font-color-red"/>
                        </f:facet>                        
                    </h:panelGroup>
                    <h:panelGrid columns="10" id="id_acao" styleClass="margin-top-max">
                        <h:column rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}">
                            <h:column rendered="false">
                                <p:commandButton value="Gerar Parcelas" title="Gerar Parcelas" rendered="#{!matriculaAcademiaBean.desabilitaCamposMovimento}" disabled="#{controleAcessoBean.botaoSalvar}" onclick="PF('dlg_save_movimento').show();" type="button"/>
                            </h:column>
                        </h:column>

                        <h:column rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}">
                            <h:column rendered="true">
                                <p:commandButton value="Desfazer Movimento" title="Desfazer Movimento" rendered="#{matriculaAcademiaBean.desabilitaCamposMovimento}" disabled="#{controleAcessoBean.botaoExcluir}" onclick="PF('dlg_delete_movimento').show();" type="button"/>
                            </h:column>
                        </h:column>  

                        <p:commandButton value="Salvar" disabled="#{controleAcessoBean.botaoSalvar or matriculaAcademiaBean.disabled}" onclick="PF('dlg_save').show()" type="button" />

                        <p:commandButton value="Novo" action="#{matriculaAcademiaBean.clear()}" update="form_matricula_academia:"/>

                        <p:commandButton value="Excluir" disabled="#{controleAcessoBean.botaoExcluir}" onclick="PF('dlg_delete').show()" type="button" rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}"/>

                        <p:commandButton value="Pesquisar" action="#{chamadaPaginaBean.pesquisa('pesquisaMatriculaAcademia')}" />

                        <h:column rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}">
                            <p:commandButton value="Inativar" onclick="PF('dlg_inative').show()" disabled="#{!matriculaAcademiaBean.matriculaAcademia.servicoPessoa.ativo or controleAcessoBean.verificarPermissao('inativa_matricula_academia', 3)}"/>
                        </h:column>

                        <h:column rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}">
                            <p:commandButton value="Renovar Matrícula" onclick="PF('dlg_renovar_matricula').show()" disabled="#{!matriculaAcademiaBean.matriculaAcademia.servicoPessoa.ativo or controleAcessoBean.verificarPermissao('renovar_matricula_academia', 3)}"/>
                        </h:column>

                        <h:column rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}">
                            <p:commandButton value="Trocar Matrícula" action="#{matriculaAcademiaBean.novoParaTrocaMatricula()}" disabled="#{!matriculaAcademiaBean.matriculaAcademia.servicoPessoa.ativo or controleAcessoBean.verificarPermissao('trocar_matricula_academia', 3)}" update="@form"/>
                        </h:column>

                        <h:column rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}">
                            <p:commandLink action="#{chamadaPaginaBean.pagina('movimentosReceberSocial')}" value="Movimentos a receber social" actionListener="#{genericaSessao.putObject('pessoaPesquisa', matriculaAcademiaBean.matriculaAcademia.servicoPessoa.cobranca)}" />
                        </h:column>

                        <h:panelGrid columns="3" rendered="#{matriculaAcademiaBean.matriculaAcademia.id != -1}">
                            <p:commandLink type="button" value="Carnê" title="Carnê" action="#{matriculaAcademiaBean.gerarCarne}" target="#{matriculaAcademiaBean.target}" rendered="#{matriculaAcademiaBean.desabilitaGeracaoContrato}" disabled="#{controleAcessoBean.botaoSalvar}" />
                        </h:panelGrid>
                    </h:panelGrid>

                    <p:dialog widgetVar="dlg_save" header="Deseja salvar este registro?" resizable="false" width="400" modal="true">
                        <f:facet name="footer">
                            <h:panelGrid columns="2">
                                <p:commandButton value="Confirmar" type="submit" styleClass="ui-confirmdialog-yes" action="#{matriculaAcademiaBean.save()}" onclick="PF('dlg_save').hide();PF('dlg_message').show();" style="clear: both; float: left; margin-left: 10px;" update="id_mensagem  id_panel_cadastro id_acao"/> 
                                <p:commandButton value="Cancelar"  type="button" styleClass="ui-confirmdialog-no" onclick="PF('dlg_save').hide()" style="float: left;" icon="ui-icon-close"/>                            
                            </h:panelGrid>
                        </f:facet>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_delete" header="Deseja excluir este registro?" resizable="false" width="400" modal="true">
                        <f:facet name="footer">
                            <h:panelGrid columns="2">
                                <p:commandButton value="Confirmar" type="submit" styleClass="ui-confirmdialog-yes" action="#{matriculaAcademiaBean.delete()}" onclick="PF('dlg_delete').hide();PF('dlg_message').show();" style="clear: both; float: left; margin-left: 10px;" update="id_mensagem id_panel_cadastro id_acao"/> 
                                <p:commandButton value="Cancelar"  type="button" styleClass="ui-confirmdialog-no" onclick="PF('dlg_delete').hide()" style="float: left;" icon="ui-icon-close"/>                            
                            </h:panelGrid>
                        </f:facet>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_save_movimento" header="Deseja salvar este movimento?" resizable="false" width="400" modal="true">
                        <f:facet name="footer">
                            <h:panelGrid columns="2">
                                <p:commandButton value="Confirmar" type="submit" styleClass="ui-confirmdialog-yes" action="#{matriculaAcademiaBean.gerarMovimento()}" onclick="PF('dlg_save_movimento').hide();" style="clear: both; float: left; margin-left: 10px;" update="id_mensagem_growl id_acao id_panel_cadastro"/> 
                                <p:commandButton value="Cancelar"  type="button" styleClass="ui-confirmdialog-no" onclick="PF('dlg_save_movimento').hide()" style="float: left;" icon="ui-icon-close"/>
                            </h:panelGrid>
                        </f:facet>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_delete_movimento" header="Deseja excluir este movimento?" resizable="false" width="400" modal="true">
                        <f:facet name="footer">
                            <h:panelGrid columns="2">
                                <p:commandButton value="Confirmar" type="submit" styleClass="ui-confirmdialog-yes" action="#{matriculaAcademiaBean.desfazerMovimento()}" onclick="PF('dlg_delete_movimento').hide();" style="clear: both; float: left; margin-left: 10px;" update="id_mensagem_growl id_acao id_panel_cadastro"/> 
                                <p:commandButton value="Cancelar"  type="button" styleClass="ui-confirmdialog-no" onclick="PF('dlg_delete_movimento').hide()" style="float: left;" icon="ui-icon-close"/>
                            </h:panelGrid>
                        </f:facet>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_message" header="Mensagem" resizable="false" width="400" modal="true" closable="true">
                        <p:outputLabel value="#{matriculaAcademiaBean.message}" id="id_mensagem" /> 
                        <f:facet name="footer">
                            <p:commandButton value="OK" type="submit" styleClass="ui-confirmdialog-yes" onclick="PF('dlg_message').hide();"/>
                        </f:facet>
                    </p:dialog>

                    <p:dialog id="id_painel_trocar_responsavel"  widgetVar="dlg_painel_trocar_responsavel" modal="true" header="Selecione a pesquisa" resizable="false">
                        <h:panelGrid columns="2">
                            <p:commandButton value="Pessoa física" icon="ui-icon-search" action="#{chamadaPaginaBean.pesquisaPessoaFisica}" title="Pesquisar pessoa física" id="idPesquisarPFisica" rendered="#{matriculaAcademiaBean.aluno.pessoa.id != -1 and matriculaAcademiaBean.socio == ''}" disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" >
                                <p:ajax event="click" listener="#{matriculaAcademiaBean.pesquisaFisica('responsavel')}" />
                            </p:commandButton>
                            <p:commandButton value="Pessoa jurídica" icon="ui-icon-search" action="#{chamadaPaginaBean.pagina('pesquisaPessoaJuridica')}" title="Pesquisar pessoa jurídica" id="idPesquisarPJuridica" rendered="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.pessoa.id != -1 and matriculaAcademiaBean.socio == ''}"  disabled="#{matriculaAcademiaBean.desabilitaCamposMovimento}" />
                        </h:panelGrid>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_inative" modal="true" header="Deseja inativar esta matrícula?" resizable="true" width="400">
                        <h:panelGrid columns="1" style="width: 100%">
                            <p:outputLabel value="Motivo Inativação" />
                            <p:inputTextarea value="#{matriculaAcademiaBean.matriculaAcademia.motivoInativacao}" style="width: 100%"/>
                        </h:panelGrid>
                        <f:facet name="footer">
                            <p:commandButton icon="ui-icon-check" value="Inativar" title="Inativar matricula" action="#{matriculaAcademiaBean.inative}" update=":form_matricula_academia:" style="font-weight: bold"/>
                            <p:commandButton icon="ui-icon-close" value="Cancelar" onclick="PF('dlg_inative').hide()"/>
                        </f:facet>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_pessoa_juridica_card" modal="true" resizable="false" height="400" width="600" header="Detalhes">
                        <p:ajax event="close" listener="#{pessoaCardBean.close}"/>  
                        <p:panel id="i_pessoa_juridica_card">
                            <ui:include src="templates/templatePessoaJuridicaCard.xhtml">
                                <ui:param name="idPessoa" value="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.cobranca.id}" />
                            </ui:include>      
                        </p:panel>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_pessoa_fisica_card" modal="true" resizable="false" height="400" width="400" header="Detalhes">
                        <p:ajax event="close" listener="#{pessoaCardBean.close}"/>  
                        <p:panel id="i_pessoa_fisica_card">
                            <ui:include src="templates/templatePessoaFisicaCard.xhtml">
                                <ui:param name="idPessoa" value="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.pessoa.id}" />
                            </ui:include>      
                        </p:panel>
                    </p:dialog>                    
                    <p:dialog widgetVar="dlg_pessoa_card" modal="true" resizable="false" height="400" width="400" header="Detalhes">
                        <p:ajax event="close" listener="#{pessoaCardBean.close}"/>  
                        <p:panel id="i_pessoa_card">
                            <ui:include src="templates/templatePessoaCard.xhtml">
                                <ui:param name="idPessoa" value="#{matriculaAcademiaBean.matriculaAcademia.servicoPessoa.cobranca.id}" />
                            </ui:include>      
                        </p:panel>
                    </p:dialog>

                    <p:dialog widgetVar="dlg_renovar_matricula" modal="true" resizable="false" height="120" width="400" header="Detalhes">
                        <p:outputLabel value="DESEJA REALMENTE RENOVAR ESTE CADASTRO?" style="font-size: 12pt!important"/><br />
                        <p:outputLabel value="ATENÇÃO: Esta ação apagará TODOS MOVIMENTOS EM ABERTO DESTE SERVIÇO e PESSOA." style="font-size: 8pt!important; color: red"/><br /><br />

                        <p:commandButton value="SIM" type="submit" styleClass="ui-confirmdialog-yes" action="#{matriculaAcademiaBean.renovarMatricula()}" update="@form" style="clear: both; float: left" icon="ui-icon-check" />
                        <p:commandButton value="NÃO" type="button" styleClass="ui-confirmdialog-no" onclick="PF('dlg_renovar_matricula').hide()" style="float: left" icon="ui-icon-close"/>       
                    </p:dialog>
                </h:form>
            </p:panel>
        </f:view>
    </h:body>
</ui:composition>